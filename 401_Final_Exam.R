# 401-DL Final Exam
# Last updated: 2015-06-06 by MJG

# -----------------------------------------------------------------------------
# `Q1`
# -----------------------------------------------------------------------------

p <- (0.86*0.14)/((0.86*0.14)+(0.65*0.35)); p

# -----------------------------------------------------------------------------
# `Q2`
# -----------------------------------------------------------------------------

x <- c(0, 1, 2, 3, 4)
p <- c(0.37, 0.13, 0.06, 0.15, 0.29)

mu <- sum(x*p)
var <- sum(((x-mu)**2)*(p))
sd <- sqrt(var)
Q2 <- round(sd, 2); Q2

# -----------------------------------------------------------------------------
# `Q3`
# -----------------------------------------------------------------------------

# 99.7% of data fall within 3 standard deviations of the mean.
sd3 <- 0.997
Q3 <- 1-sd3; Q3

# -----------------------------------------------------------------------------
# `Q4`
# -----------------------------------------------------------------------------

min <- -3
max <- 14
mu <- (min + max) / 2; mu
sd <- (max-min)/sqrt(12); sd

# -----------------------------------------------------------------------------
# `Q6`
# -----------------------------------------------------------------------------

n <- 85
x <- 49
alpha <- 0.02

p <- x/n
q <- 1-p

z <- qnorm(1-alpha/2)

oi <- sqrt((q*p)/n)

p - (z*oi)
p + (z*oi)

# -----------------------------------------------------------------------------
# `Q7`
# -----------------------------------------------------------------------------

alpha <- 0.01
r <- 0.543
n <- 25

t <- (r)*(sqrt((n-2)/(1-(r**2)))); t
qt <- qt(1-alpha/2, n-2); qt
qt(1-0.05/2, 45)

# -----------------------------------------------------------------------------
# `Q8`
# -----------------------------------------------------------------------------

x.n <- 16
x.mu <- 73
x.sd <- 10.9

y.n <- 12
y.mu <- 68.4
y.sd <- 8.2

# Determine standard error
SE <- sqrt((x.sd**2/x.n)+(y.sd**2/y.n))

# Determine degrees of freedom
df <- (x.n - 1)+(y.n - 1); df

# Determine critical value for t for 95% CI @ DF
cval <- qt((1-0.05/2), df)

t1 <- (x.mu - y.mu)
t2 <- sqrt(((x.sd**2)*(x.n-1)+(y.sd**2)*(y.n-1))/(df))
t3 <- sqrt((1/x.n)+(1/y.n))

t <- t1/(t2*t3); t

# -----------------------------------------------------------------------------
# `Q10`
# -----------------------------------------------------------------------------

# Use the data provided to find the equation of the simple linear regression
# line. Let x be the independent variable and y the dependent variable.  You may
# use the SSxy and SSxx values provided or alternative methods of your choice.  
# Business Statistics Chapter 12 addresses this topic.  yhat denotes the 
# predicted value for y.  Round to one decimal place.

x <- c(1, 3, 5, 7, 9)
y <- c(143, 116, 100, 98, 90)

lm(y~x)